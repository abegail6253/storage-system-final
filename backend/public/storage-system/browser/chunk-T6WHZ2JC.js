import{b as y,f as v,g as T}from"./chunk-MFIUDOJK.js";import{b as P,c as S,d as k,e as L,f as O,g as I,h as E,i as N}from"./chunk-D3U76ZEN.js";import{c as M}from"./chunk-UEJFEWYP.js";import{Eb as x,Gb as C,Ob as s,Qb as p,Rb as m,Sb as c,Tb as f,Va as a,Wa as l,fb as b,lb as _,sb as g,vc as h,xb as n,yb as o,yc as w}from"./chunk-DV5UHSU4.js";function R(d,i){if(d&1&&(n(0,"div",9),s(1),o()),d&2){let e=C();a(),p(" ",e.errorMessage," ")}}var z=class d{constructor(i,e,t){this.router=i;this.http=e;this.jwtService=t}username="";password="";errorMessage="";isLoading=!1;onSubmit(){this.isLoading=!0;let i={username:this.username,password:this.password};console.log("Sending login request with data:",i),this.http.post("http://localhost:3001/login",i).subscribe(e=>{if(this.isLoading=!1,e?.token){this.jwtService.saveToken(e.token);let t=this.decodeToken(e.token);localStorage.setItem("email",t.email),console.log("Login successful, token received:",e.token),console.log("User email extracted from token:",t.email),console.log(`User logged in: ${t.email}`),this.router.navigate(["/dashboard"])}else this.errorMessage="Login failed, no token received"},e=>{this.isLoading=!1,console.error("Login failed, error:",e),this.errorMessage=e?.error?.message||"Login failed, please try again",e?.error&&console.error("Error Response:",e.error)})}decodeToken(i){let e=i.split(".")[1],t=atob(e);return JSON.parse(t)}static \u0275fac=function(e){return new(e||d)(l(y),l(M),l(T))};static \u0275cmp=b({type:d,selectors:[["app-login"]],decls:15,vars:5,consts:[[1,"login-container"],[3,"ngSubmit"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","placeholder","Enter your username","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","placeholder","Enter your password","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["class","error",4,"ngIf"],[1,"error"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"h2"),s(2,"Login"),o(),n(3,"form",1),x("ngSubmit",function(){return t.onSubmit()}),n(4,"div",2)(5,"label",3),s(6,"Username:"),o(),n(7,"input",4),f("ngModelChange",function(r){return c(t.username,r)||(t.username=r),r}),o()(),n(8,"div",2)(9,"label",5),s(10,"Password:"),o(),n(11,"input",6),f("ngModelChange",function(r){return c(t.password,r)||(t.password=r),r}),o()(),n(12,"button",7),s(13),o(),_(14,R,2,1,"div",8),o()()),e&2&&(a(7),m("ngModel",t.username),a(4),m("ngModel",t.password),a(),g("disabled",!t.username||!t.password||t.isLoading),a(),p(" ",t.isLoading?"Logging in...":"Login"," "),a(),g("ngIf",t.errorMessage))},dependencies:[w,h,N,I,P,S,k,E,O,L,v],styles:['.login-container[_ngcontent-%COMP%]{width:400px;margin:100px auto;padding:40px;background:linear-gradient(135deg,#0d0d0d,#333);border-radius:15px;box-shadow:0 15px 35px #0006;text-align:center;color:#fff;font-family:Roboto,sans-serif;position:relative;overflow:hidden;animation:_ngcontent-%COMP%_glowPulse 2s infinite alternate}@keyframes _ngcontent-%COMP%_glowPulse{0%{box-shadow:0 15px 35px #0006,0 0 30px #007bff99}to{box-shadow:0 15px 35px #0006,0 0 50px #007bffe6}}h2[_ngcontent-%COMP%]{font-size:30px;margin-bottom:30px;color:#007bff;letter-spacing:2px;text-transform:uppercase}input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%;padding:15px;margin:15px 0;border:none;border-radius:8px;background-color:#ffffff1a;color:#fff;font-size:16px;box-sizing:border-box;transition:all .3s ease-in-out;outline:none}input[type=text][_ngcontent-%COMP%]:focus, input[type=password][_ngcontent-%COMP%]:focus{border:2px solid #007bff;background-color:#fff3;box-shadow:0 0 15px #007bffb3}button[_ngcontent-%COMP%]{width:100%;padding:15px;background:linear-gradient(135deg,#007bff,#0056b3);color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:18px;font-weight:700;text-transform:uppercase;letter-spacing:1px;transition:background .4s ease-in-out,transform .3s ease}button[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#0056b3,#003580);transform:scale(1.05)}button[disabled][_ngcontent-%COMP%]{background:#444;cursor:not-allowed}.error[_ngcontent-%COMP%]{color:#ff4d4d;margin-top:20px;font-size:14px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.login-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .6s ease-in-out}.login-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.1),transparent);transform:rotate(30deg);animation:_ngcontent-%COMP%_rotate 6s linear infinite;z-index:0;opacity:.3}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.login-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;z-index:1}']})};export{z as LoginComponent};
